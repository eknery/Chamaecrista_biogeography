### load libraries
if(!require("tidyverse")) install.packages("tidyverse"); library("tidyverse")
if(!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if(!require("phangorn")) install.packages("phangorn"); library("phangorn")
if(!require("seqinr")) install.packages("seqinr"); library("seqinr")
### input diretory
dir_input = "1_initial_sequences/"
file_names = list.files(dir_input)
### loading data
fasta_list = list()
for(i in 1:length(file_names) ){
fasta_list[[i]] = read.phyDat(paste0(dir_input, file_names[i]),
format = "fasta",
type = "DNA"
)
names(fasta_list)[i] = str_remove(string = file_names[i],
pattern = ".fasta")
}
### all spp names
all_names = c()
for(i in 1:length(fasta_list)){
all_names = c(all_names, names(fasta_list[[i]]))
}
all_names = sort(unique(all_names))
fasta_list
fasta_list$ETS
names(fasta_list$ETS)
fasta_list[i]
spp_marker = c()
for( i in length(fasta_list)){
bin = names(fasta_list[[i]]) %in%  all_names
spp_marker = cbind(spp_marker, bin)
}
spp_marker
names(fasta_list[[i]]) %in%  all_names
i
spp_marker = c()
for( i in length(fasta_list)){
bin = names(fasta_list[[i]]) %in%  all_names
spp_marker = cbind(spp_marker, bin)
}
spp_marker
names(fasta_list[[i]]) %in%  all_names
spp_marker = c()
for( i in 1:length(fasta_list)){
bin = names(fasta_list[[i]]) %in%  all_names
spp_marker = cbind(spp_marker, bin)
}
spp_marker
fasta_list[[i]]
length(fasta_list)
names(fasta_list[[i]]) %in% all_names
all_names
spp_marker = c()
for( i in 1:length(fasta_list)){
bin = all_names %in% names(fasta_list[[i]])
spp_marker = cbind(spp_marker, bin)
}
spp_marker
names(fasta_list)
colnames(spp_marker) = names(fasta_list)
write.csv(spp_marker, "spp_marker.csv", sep=",", quote = F, row.names = F)
write.csv(spp_marker, "spp_marker.csv", quote = F, row.names = F)
### load libraries
if(!require("tidyverse")) install.packages("tidyverse"); library("tidyverse")
if(!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if(!require("phangorn")) install.packages("phangorn"); library("phangorn")
if(!require("seqinr")) install.packages("seqinr"); library("seqinr")
### input diretory
dir_input = "1_initial_sequences/"
file_names = list.files(dir_input)
### loading data
fasta_list = list()
for(i in 1:length(file_names) ){
fasta_list[[i]] = read.phyDat(paste0(dir_input, file_names[i]),
format = "fasta",
type = "DNA"
)
names(fasta_list)[i] = str_remove(string = file_names[i],
pattern = ".fasta")
}
### all spp names
all_names = c()
for(i in 1:length(fasta_list)){
all_names = c(all_names, names(fasta_list[[i]]))
}
all_names = sort(unique(all_names))
spp_marker = read.table("spp_marker.csv")
spp_marker
spp_marker = read.table("spp_marker.csv", sep = ",")
spp_marker
spp_marker = read.table("spp_marker.csv", sep = ",", h= T)
spp_marker
spp_marker = cbind(all_names, spp_marker)
spp_marker
write.csv(spp_marker, "spp_marker2.csv")
write.csv(spp_marker, "spp_marker2.csv", row.names = F)
